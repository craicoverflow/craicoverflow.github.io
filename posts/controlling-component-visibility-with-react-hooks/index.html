<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Controlling component visibility with React Hooks | Enda Phelan</title>

<meta property='og:title' content='Controlling component visibility with React Hooks - Enda Phelan'>
<meta property='og:description' content='A guide to controlling the visibility of your components using React Hooks'>
<meta property='og:url' content='https://endaphelan.me/posts/controlling-component-visibility-with-react-hooks/'>
<meta property='og:site_name' content='Enda Phelan'>
<meta property='og:type' content='article'><meta property='og:image' content='https://i.imgur.com/f83hzUs.jpg'><meta property='article:published_time' content='2019-04-22T00:00:00Z'/><meta property='article:modified_time' content='2019-04-22T00:00:00Z'/><meta name='twitter:card' content='summary_large_image'><meta name='twitter:site' content='@PhelanEnda'><meta name='twitter:creator' content='@PhelanEnda'>


<link href="https://endaphelan.me/index.xml" rel="alternate" type="application/rss+xml" title="Enda Phelan" />

<link rel="stylesheet" href="/css/style.css"/><link rel='stylesheet' href='https://endaphelan.me/css/custom.css'><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://endaphelan.me/posts/controlling-component-visibility-with-react-hooks/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://endaphelan.me">
          <h1 id="nav-heading" class="title is-4">Enda Phelan</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="github" href='https://github.com/craicoverflow'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/PhelanEnda'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="instagram" href='https://instagram.com/enda.phelan'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/>
    <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
    <line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:hello@endaphelan.me'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/endaphelan'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>
<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/react/">#React</a>



  
  | <a class="subtitle is-6" href="/tags/react-hooks/">#React hooks</a>
  


      
    </div>
    <h2 class="subtitle is-6">April 22, 2019</h2>
    <h1 class="title">Controlling component visibility with React Hooks</h1>
    
    <div class="content">
      <!-- raw HTML omitted -->
<p>With the release of React 16.8, <em>Hooks</em> are the newest addition to the world&rsquo;s most popular front-end framework. Hooks give us access to state and other lifecycle events from functional components. Before now functional components were always stateless. To use state we had to write class components, which are more verbose and complex than their functional counterparts.</p>
<p>In this guide we are going to make a simple component which will remain hidden until a button is clicked. We will also set a timeout event to hide the component after a set duration.</p>
<p>For this we will use two hooks - <code>useState</code> and <code>useEffect</code>. I&rsquo;ll explain what they do when we go to implement them, but for now let&rsquo;s define the component and its props.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Alert</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">visible</span>, <span style="color:#a6e22e">duration</span>, <span style="color:#a6e22e">onDurationEnd</span>, <span style="color:#a6e22e">children</span> }) =&gt; {
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">children</span>;
};
</code></pre></div><p>I&rsquo;ve defined a functional component with four props.</p>
<ul>
<li><code>visible</code> (required) - This will be a boolean, either <code>true</code> or <code>false</code>. It controls the current visible state of the component.</li>
<li><code>duration</code> (optional) - This is the duration is milliseconds that the component should display for before hiding again. If it is not set, the component will remain visible.</li>
<li><code>onDurationEnd</code> (optional) - Callback function that executes after the duration has ended. Typically used reset the component&rsquo;s visibility to <code>false</code> from the parent component.</li>
<li><code>children</code> (required) - This can be anything, from a single word to multiple components. <code>children</code> are added to the component as child elements.</li>
</ul>
<h3 id="state">State</h3>
<p><code>useState</code> allows us to use and set component state, which persists across renders. <code>useState</code> returns a pair, the current state value and a function for modifying it. Finally, <code>useState</code> takes a single argument which sets the initial value.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;react&#34;</span>;

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Alert</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">visible</span>, <span style="color:#a6e22e">duration</span>, <span style="color:#a6e22e">onDurationEnd</span>, <span style="color:#a6e22e">children</span> }) =&gt; {
    <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">isVisible</span>, <span style="color:#a6e22e">setVisibility</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#66d9ef">null</span>);

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">children</span>;
};
</code></pre></div><p>Here we have set up a hook to control the visibility of the component. The initial state value is <code>null</code> as this will be overwritten almost immediately after render.</p>
<p>What I really like about <code>useState</code> is you can declare it multiple times in a single component.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">isVisible</span>, <span style="color:#a6e22e">setVisibility</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#66d9ef">null</span>);
<span style="color:#75715e">// defining a second state variable
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">setMessage</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#66d9ef">null</span>);
</code></pre></div><p>The benefit of this is that we can separate the control of different state values. In a class component, all state values are in a single object. So if you want to update one, you must also update the rest.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setVisibility</span>(<span style="color:#a6e22e">visible</span>) {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({
        ...<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>,
        <span style="color:#a6e22e">isVisible</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">visible</span>
    });
}
</code></pre></div><h3 id="effect">Effect</h3>
<p><code>useEffect</code> lets us perform side effect functions from a functional component. A side effect is something which affects something outside of the function being executed, like state or a network request. Think of <code>useEffect</code> like <code>componentDidMount</code>, <code>componentDidUpdate</code> and <code>componentWillUpdate</code> combined. By using this hook, you tell React to execute the logic inside the hook after every render.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Alert</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">visible</span>, <span style="color:#a6e22e">duration</span>, <span style="color:#a6e22e">onDurationEnd</span>, <span style="color:#a6e22e">children</span> }) =&gt; {
    <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">isVisible</span>, <span style="color:#a6e22e">setVisibility</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#66d9ef">null</span>);

    <span style="color:#a6e22e">useEffect</span>(() =&gt; {
        <span style="color:#a6e22e">setVisibility</span>(<span style="color:#a6e22e">visible</span>); <span style="color:#75715e">// update the state
</span><span style="color:#75715e"></span>    }, [<span style="color:#a6e22e">visible</span>]); <span style="color:#75715e">// hook is only triggered when value changes
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">children</span>;
};
</code></pre></div><p>So what does this do? After setting the initial state value, the <code>useEffect</code> hook is the next event to run. The hook overrides the initial value for <code>isVisible</code> to match the value acquired from the parent component&rsquo;s props.</p>
<p>The final argument in <code>useEffect</code> is an optional optimization. The effect will only re-run the if the value of <code>visible</code> changes, preventing unnecessary re-renders.</p>
<!-- raw HTML omitted -->
<p>Once the <code>useEffect</code> hook has finished, we want to check the value of <code>isVisible</code>. If it&rsquo;s <code>false</code>, we don&rsquo;t want to render the component, so we return <code>null</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isVisible</span>) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</code></pre></div><p>If <code>duration</code> contains a value, we need to set a timeout which will reset the component&rsquo;s visibility once the duration has passed. If <code>onDurationEnd</code> is defined then the parent component expects the value for controlling this component&rsquo;s visibility to also be reset to <code>false</code>, once the timeout has complete.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">duration</span>) {
    <span style="color:#a6e22e">setTimeout</span>(() =&gt; {
        <span style="color:#a6e22e">setVisibility</span>(<span style="color:#66d9ef">false</span>);

        <span style="color:#75715e">// pass `false` back to the parent to update its state
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">onDurationEnd</span>) {
            <span style="color:#a6e22e">onDurationEnd</span>(<span style="color:#66d9ef">false</span>);
        }
    }, <span style="color:#a6e22e">duration</span>);
}
</code></pre></div><p>Take a look at the finished component below. The introduction of React hooks has made developing components quicker, with fewer lifecyle events to worry about. The file itself is reduced by a number of lines versus a class component that does the same thing.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span>, <span style="color:#a6e22e">useEffect</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;react&#34;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">PropTypes</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;prop-types&#34;</span>;

<span style="color:#75715e">/**
</span><span style="color:#75715e"> * Customisable alert component that remains hidden until called.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * @param {boolean} props.visible - The current visibility of the component.
</span><span style="color:#75715e"> * @param {number} [props.duration] - The time in milliseconds to display the component for. If not set, the component will stay visible.
</span><span style="color:#75715e"> * @param {func} onDurationEnd - Set visible state of component from parent.
</span><span style="color:#75715e"> * @param {*} props.children - Child components.
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Alert</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">visible</span>, <span style="color:#a6e22e">duration</span>, <span style="color:#a6e22e">onDurationEnd</span>, <span style="color:#a6e22e">children</span> }) =&gt; {
    <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">isVisible</span>, <span style="color:#a6e22e">setVisibility</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#66d9ef">null</span>);

    <span style="color:#a6e22e">useEffect</span>(() =&gt; {
        <span style="color:#a6e22e">setVisibility</span>(<span style="color:#a6e22e">visible</span>);
    }, [<span style="color:#a6e22e">visible</span>]);

    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isVisible</span>) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;

    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">duration</span>) {
        <span style="color:#a6e22e">setTimeout</span>(() =&gt; {
            <span style="color:#a6e22e">setVisibility</span>(<span style="color:#66d9ef">false</span>);

            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">onDurationEnd</span>) {
                <span style="color:#a6e22e">onDurationEnd</span>(<span style="color:#66d9ef">false</span>);
            }
        }, <span style="color:#a6e22e">duration</span>);
    }

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">children</span>;
};

<span style="color:#a6e22e">Alert</span>.<span style="color:#a6e22e">propTypes</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">visible</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PropTypes</span>.<span style="color:#a6e22e">bool</span>.<span style="color:#a6e22e">isRequired</span>,
    <span style="color:#a6e22e">timeout</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PropTypes</span>.<span style="color:#a6e22e">number</span>,
    <span style="color:#a6e22e">children</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PropTypes</span>.<span style="color:#a6e22e">node</span>.<span style="color:#a6e22e">isRequired</span>
};
</code></pre></div><p>Check out a <a href="https://endaphelan.me/react-hooks-timeout-example/">live demo</a> or the code from this tutorial on <a href="https://github.com/craicoverflow/react-hooks-timeout-example">GitHub</a>.</p>
<p>And I can&rsquo;t let you go without a meme.</p>
<!-- raw HTML omitted -->

      
      <div class="related">
</div>
      
    </div>
    
  </div>
</section>

    <script src="/js/copycode.js"></script>



<section class="section">
  <div class="container has-text-centered">
    <p>&copy; <a href="https://github.com/craicoverflow">Enda Phelan</a> 2020</p>
    
      <p>Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/ribice/kiss">Kiss</a>.</p>
    
  </div>
</section>



</body>
</html>

